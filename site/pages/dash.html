<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard | WaterWorks</title>

    <link rel="stylesheet" href="../css/estiloNovaDash.css">

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Rubik:ital,wght@0,300..900;1,300..900&display=swap" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Rubik:ital,wght@0,300..900;1,300..900&display=swap');
    </style>


</head>
<body>

    <header id="headerSuperior">
        <h2>WaterWorks</h2>
        <div>
            <b id="nomeEmpresa">Empresa</b>
        </div>
    </header>

    
    
    <main id="main">
        <header id="headerLateral">
            
            <div id="nomeUsuario">
                Seja bem-vindo, Usuário
            </div>
            <button>Logout</button>
        </header>
    
        <div id="div_grafico_foda">
          <canvas id="myChart"></canvas>
          </div>
    

        <section id="graficos">

            <menu>
                <select onselect="plotar()" id="listaPlant">
                    <option value="#" selected disabled>Selecione uma plantação</option>
                    <option value="1" >Plantação 1</option>
                    <option value="2" >Plantação 2</option>
                </select>
                <button onclick="plotar()" >Selecionar</button>
            </menu>
    
            <section id="plantacao1" style="display: none;">
                <div id="graficoMensalPlant1">
                    <div class="kpiNaoEstatica">
                        <div class="kpi">Média dos Últimos Meses: <br> 67%</div>
                        <div class="kpi">Status: <br> IDEAL</div>
                    </div>
                    <div class="grafico">
                        <div class="kpiEstatica">
                            <div class="kpi">Umidade Máxima: <br> 80%</div>
                            <div class="kpi">Umidade Mínima: <br> 60%</div>
                        </div>
                        <canvas id="myChart2"></canvas>
                    </div>
                </div>
                <div id="graficoDiarioPlant1">
                    <div class="kpiNaoEstatica">
                        <div class="kpi">Média dos Últimos Meses: <br> 67%</div>
                        <div class="kpi">Status: <br> IDEAL</div>
                    </div>
                    <div class="grafico">
                        <div class="kpiEstatica">
                            <div class="kpi">Umidade Máxima: <br> 80%</div>
                            <div class="kpi">Umidade Mínima: <br> 60%</div>
                        </div>
                    </div>
                </div>
    
                <div>
                    <button onclick="graficoMensal()" class="btnMudarGrafico">Gráfico Mensal</button>
                    <button onclick="graficoDiario() " class="btnMudarGrafico">Gráfico Diário</button>
                </div>
            </section>
    
    
            <section id="plantacao2" style="display: none;">
                <div id="graficoMensalPlant2">
                    <div class="kpiNaoEstatica">
                        <div class="kpi">Média dos Últimos Meses: <br> 59%</div>
                        <div class="kpi">Status: <br> IDEAL</div>
                    </div>
                    <div class="grafico">
                        <div class="kpiEstatica">
                            <div class="kpi">Umidade Máxima: <br> 80%</div>
                            <div class="kpi">Umidade Mínima: <br> 60%</div>
                        </div>
                        <canvas id="myChart4"></canvas>
                    </div>
                </div>
                <div id="graficoDiarioPlant2" style="display: none;">
                    <div class="kpiNaoEstatica">
                        <div class="kpi">Média dos Últimos Meses: <br> 66%</div>
                        <div class="kpi">Status: <br> IDEAL</div>
                    </div>
                    <div class="grafico">
                        <div class="kpiEstatica">
                            <div class="kpi">Umidade Máxima: <br> 80%</div>
                            <div class="kpi">Umidade Mínima: <br> 60%</div>
                        </div>
                        <canvas id="myChart3"></canvas>
                    </div>
                </div>
    
                <div>
                    <button onclick="graficoMensalPlant2()" class="btnMudarGrafico">Gráfico Mensal</button>
                    <button onclick="graficoDiarioPlant2()" class="btnMudarGrafico">Gráfico Diário</button>
                </div>
            </section>
        </section>
    </main>
</body>
</html>
<script>
  function plotar() {  
  var idPLANTACAO = Number(listaPlant.value);
    
  fetch("/usuarios/plotar", {
        method: "POST",
        headers: {
            "Content-Type": "application/json",
        },
        body: JSON.stringify({
            idPLANTACAO: idPLANTACAO,
        }),
        })
        .then(function (resposta) {
            console.log("resposta: ", resposta);

            if (resposta.ok) {
                
            } 
        })
        .catch(function (resposta) {
            console.log(`#ERRO: ${resposta}`);
            finalizarAguardar();
        });


    fetch(`/usuarios/plotar`, {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify({
        idPLANTACAO: idPLANTACAO,
      }),
    })
      .then((resposta) => {
        resposta
          .json()
          .then((dados) => {
            "";
            
            // div_kpi_evasive.innerHTML = dados[0].evasive;
            // div_kpi_smooth.innerHTML = dados[0].smooth;
            // div_kpi_reactive.innerHTML = dados[0].reactive;

            console.log(dados[0].Dado,dados[0].registro, )

            const ctx = document.getElementById("myChart");


            new Chart(ctx, {
              type: "line",
              data: {
                labels: [
                  dados[0].registro,
                  
                ],
                
                datasets: [
                  {
                    data: [
                      dados[0].Dado,
                    ],
                    borderWidth: 1,
                  },
                ],
              },
              options: {
                plugins: {
                  legend: {
                    display: false,
                  },
                  title: {
                    display: true,
                    text: "Comparação das categorias",
                  },
                },
                scales: {
                  y: {
                    beginAtZero: true,
                  },
                },
              },
            });
          })
          .catch((erro) => {
            console.log(erro);
          });
      })
      .catch((erro) => {
        console.log(erro);
      });
  }


    // function selecionarPlant() {

    //     var lista = listaPlant.value

    //     if (lista == 1) {
    //         document.getElementById('plantacao1').style.display = 'flex'
    //         document.getElementById('plantacao2').style.display = 'none'
    //     } else if (lista == 2) {
    //         document.getElementById('plantacao1').style.display = 'none'
    //         document.getElementById('plantacao2').style.display = 'flex'
    //     }
    // }

    // function plantacao1() {
    //     document.getElementById('selecionarPlantacao').style.display = 'none'
    //     document.getElementById('plantacao2').style.display = 'none'
    //     document.getElementById('plantacao1').style.display = 'flex'
    // }

    // function plantacao2() {
    //     document.getElementById('selecionarPlantacao').style.display = 'none'
    //     document.getElementById('plantacao2').style.display = 'flex'
    //     document.getElementById('plantacao1').style.display = 'none'
    // }

    // function graficoDiario() {
    //     document.getElementById('graficoMensalPlant1').style.display = 'none'
    //     document.getElementById('graficoDiarioPlant1').style.display = 'flex'
    // }

    // function graficoMensal() {
    //     document.getElementById('graficoMensalPlant1').style.display = 'flex'
    //     document.getElementById('graficoDiarioPlant1').style.display = 'none'
    // }

    // function graficoDiarioPlant2() {
    //     document.getElementById('graficoMensalPlant2').style.display = 'none'
    //     document.getElementById('graficoDiarioPlant2').style.display = 'flex'
    // }

    // function graficoMensalPlant2() {
    //     document.getElementById('graficoMensalPlant2').style.display = 'flex'
    //     document.getElementById('graficoDiarioPlant2').style.display = 'none'
    // }

    // Chart plantação 1

//     const ctx1 = document.getElementById('myChart')

//     new Chart(ctx1, {
//     type: "line",
//     data: {
//         labels: [
//             "12:00", "12:15", "12:30", "12:45", "13:00", "13:15",
//             "13:30", "13:45", "14:00", "14:15", "14:30", "14:45",
//         ],
//         datasets: [
//             {
//                 label: "Sensor Umidade 01 (%)",
//                 data: [45, 58, 62, 65, 70, 73, 85, 92, 68, 77, 64, 70],
//                 borderWidth: 2,
//                 borderColor: '#0A8CBF',
//                 backgroundColor: 'rgba(10, 140, 191, 0.1)',
//                 tension: 0.4,
//                 fill: false,
//                 pointStyle: 'circle',
//                 pointRadius: 6,
//                 pointHoverRadius: 8,
//                 pointBackgroundColor: '#0A8CBF',
//             },
//             {
//                 label: "Umidade Geral (%)",
//                 data: [61, 64, 67, 70, 73, 76, 79, 78, 75, 72, 69, 66],
//                 borderWidth: 3,
//                 borderColor: '#58A69F',
//                 backgroundColor: 'rgba(46, 204, 113, 0.1)',
//                 tension: 0.4,
//                 fill: false,
//                 pointStyle: 'circle',
//                 pointRadius: 6,
//                 pointHoverRadius: 8,
//                 pointBackgroundColor: '#58A69F',
//             },
//         ],
//     },
//     options: {
//         responsive: true,
//         plugins: {
//             legend: {
//                 position: 'top',
//                 labels: {
//                     font: {
//                         size: 14,
//                         family: "'Arial', sans-serif"
//                     }
//                 }
//             },
//             title: {
//                 align: 'start',
//                 display: true,
//                 text: 'Monitoramento de Umidade 26 de abril',
//                 font: {
//                     size: 18,
//                     family: "'Arial', sans-serif",
//                     weight: 'bold',
//                 }
//             }
//         },
//         scales: {
//             y: {
//                 beginAtZero: false,
//                 grid: {
//                     color: 'rgba(0, 0, 0, 0.1)'
//                 },
//                 ticks: {
//                     font: {
//                         size: 12
//                     }
//                 }
//             },
//             x: {
//                 grid: {
//                     color: 'rgba(0, 0, 0, 0.1)'
//                 },
//                 ticks: {
//                     font: {
//                         size: 12
//                     }
//                 }
//             }
//         }
//     }
// })


//     const ctx2 = document.getElementById('myChart2')

// new Chart(ctx2, {
//   type: "bar",
//   data: {
//     labels: ["Janeiro", "Fevereiro", "Março", "Abril", "Maio", "Junho"],
//     datasets: [
//       {
//         label: "Umidade Geral",
//         data: [32, 45, 89, 78, 73, 76],
//         borderWidth: 2,
//         backgroundColor: "rgba(88, 166, 159, 0.6)", // Cor com transparência
//         borderColor: "#58A69F", // Cor da borda
//         hoverBackgroundColor: "rgba(88, 166, 159, 0.8)", // Cor ao passar o mouse
//         hoverBorderColor: "#58A69F", // Cor da borda ao passar o mouse
//       },
//     ],
//   },
//   options: {
//     responsive: true,
//     plugins: {
//       legend: {
//         display: true,
//         position: 'top', // Posição da legenda
//         labels: {
//           font: {
//             size: 14, // Tamanho da fonte da legenda
//             weight: 'bold', // Peso da fonte da legenda
//           },
//           color: "#333", // Cor da fonte da legenda
//         },
//       },
//       title: {
//         align: 'start',
//         display: true,
//         text: 'Gráfico de Umidade Geral (Jan - Jun)', // Título do gráfico
//         font: {
//           size: 18, // Tamanho da fonte do título
//           weight: 'bold', // Peso da fonte do título
//           color: "#333", // Cor da fonte do título
//         },
//       },
//     },
//     scales: {
//       y: {
//         beginAtZero: true, // Começar em zero
//         title: {
//           display: true,
//           text: 'Umidade (%)', // Título do eixo Y
//           font: {
//             size: 14, // Tamanho da fonte do título do eixo Y
//             weight: 'bold', // Peso da fonte do título do eixo Y
//             color: "#333", // Cor da fonte do título do eixo Y
//           },
//         },
//         grid: {
//           color: "#ddd", // Cor da grade do eixo Y
//         },
//       },
//       x: {
//         title: {
//           display: true,
//           text: 'Meses', // Título do eixo X
//           font: {
//             size: 14,
//             weight: 'bold',
//             color: "#333", // Cor da fonte do título do eixo X
//           },
//         },
//         grid: {
//           color: "#ddd", // Cor da grade do eixo X
//         },
//       },
//     },
//   },
// });

// const ctx3 = document.getElementById('myChart3')

// new Chart(ctx3, {
// type: "line",
// data: {
//     labels: [
//         "12:00", "12:15", "12:30", "12:45", "13:00", "13:15",
//         "13:30", "13:45", "14:00", "14:15", "14:30", "14:45",
//     ],
//     datasets: [
//         {
//             label: "Sensor Umidade 01 (%)",
//             data: [45, 58, 62, 65, 70, 73, 85, 92, 68, 77, 64, 70],
//             borderWidth: 2,
//             borderColor: '#0A8CBF',
//             backgroundColor: 'rgba(10, 140, 191, 0.1)',
//             tension: 0.4,
//             fill: false,
//             pointStyle: 'circle',
//             pointRadius: 6,
//             pointHoverRadius: 8,
//             pointBackgroundColor: '#0A8CBF',
//         },
//         {
//             label: "Umidade Geral (%)",
//             data: [61, 64, 67, 70, 73, 76, 79, 78, 75, 72, 69, 66],
//             borderWidth: 3,
//             borderColor: '#58A69F',
//             backgroundColor: 'rgba(46, 204, 113, 0.1)',
//             tension: 0.4,
//             fill: false,
//             pointStyle: 'circle',
//             pointRadius: 6,
//             pointHoverRadius: 8,
//             pointBackgroundColor: '#58A69F',
//         },
//     ],
// },
// options: {
//     responsive: true,
//     plugins: {
//         legend: {
//             position: 'top',
//             labels: {
//                 font: {
//                     size: 14,
//                     family: "'Arial', sans-serif"
//                 }
//             }
//         },
//         title: {
//             align: 'start',
//             display: true,
//             text: 'Monitoramento de Umidade 26 de abril',
//             font: {
//                 size: 18,
//                 family: "'Arial', sans-serif",
//                 weight: 'bold',
//             }
//         }
//     },
//     scales: {
//         y: {
//             beginAtZero: false,
//             grid: {
//                 color: 'rgba(0, 0, 0, 0.1)'
//             },
//             ticks: {
//                 font: {
//                     size: 12
//                 }
//             }
//         },
//         x: {
//             grid: {
//                 color: 'rgba(0, 0, 0, 0.1)'
//             },
//             ticks: {
//                 font: {
//                     size: 12
//                 }
//             }
//         }
//     }
// }
// })



// const ctx4 = document.getElementById('myChart4')

// new Chart(ctx4, {
//   type: "bar",
//   data: {
//     labels: ["Janeiro", "Fevereiro", "Março", "Abril", "Maio", "Junho"],
//     datasets: [
//       {
//         label: "Umidade Geral",
//         data: [32, 45, 89, 78, 73, 76],
//         borderWidth: 2,
//         backgroundColor: "rgba(88, 166, 159, 0.6)", // Cor com transparência
//         borderColor: "#58A69F", // Cor da borda
//         hoverBackgroundColor: "rgba(88, 166, 159, 0.8)", // Cor ao passar o mouse
//         hoverBorderColor: "#58A69F", // Cor da borda ao passar o mouse
//       },
//     ],
//   },
//   options: {
//     responsive: true,
//     plugins: {
//       legend: {
//         display: true,
//         position: 'top', // Posição da legenda
//         labels: {
//           font: {
//             size: 14, // Tamanho da fonte da legenda
//             weight: 'bold', // Peso da fonte da legenda
//           },
//           color: "#333", // Cor da fonte da legenda
//         },
//       },
//       title: {
//         align: 'start',
//         display: true,
//         text: 'Gráfico de Umidade Geral (Jan - Jun)', // Título do gráfico
//         font: {
//           size: 18, // Tamanho da fonte do título
//           weight: 'bold', // Peso da fonte do título
//           color: "#333", // Cor da fonte do título
//         },
//       },
//     },
//     scales: {
//       y: {
//         beginAtZero: true, // Começar em zero
//         title: {
//           display: true,
//           text: 'Umidade (%)', // Título do eixo Y
//           font: {
//             size: 14, // Tamanho da fonte do título do eixo Y
//             weight: 'bold', // Peso da fonte do título do eixo Y
//             color: "#333", // Cor da fonte do título do eixo Y
//           },
//         },
//         grid: {
//           color: "#ddd", // Cor da grade do eixo Y
//         },
//       },
//       x: {
//         title: {
//           display: true,
//           text: 'Meses', // Título do eixo X
//           font: {
//             size: 14,
//             weight: 'bold',
//             color: "#333", // Cor da fonte do título do eixo X
//           },
//         },
//         grid: {
//           color: "#ddd", // Cor da grade do eixo X
//         },
//       },
//     },
//   },
// });
</script>